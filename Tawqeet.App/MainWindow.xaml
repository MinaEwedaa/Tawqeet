<Window x:Class="Tawqeet.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Tawqeet.App"
        Title="Tawqeet Attendance System"
        Width="1400" Height="900"
        MinWidth="1200" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}"
        KeyDown="Window_KeyDown">
    
    <Window.Resources>
        <local:StatusToBackgroundConverter x:Key="StatusToBackgroundConverter"/>
        <local:BoolToConnectTextConverter x:Key="BoolToConnectTextConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="36"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryDarkBrush}">
            <Grid Margin="20,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Logo and Title -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse Width="32" Height="32" Fill="{StaticResource PrimaryBrush}" Margin="0,0,12,0">
                        <Ellipse.Effect>
                            <DropShadowEffect BlurRadius="8" ShadowDepth="0" Color="#2E7DFF" Opacity="0.5"/>
                        </Ellipse.Effect>
                    </Ellipse>
                    <TextBlock Text="((o))" FontSize="14" FontWeight="Bold" Foreground="White" 
                               VerticalAlignment="Center" Margin="-40,0,12,0"/>
                    <TextBlock Text="Tawqeet Attendance System" FontSize="18" FontWeight="Bold" 
                               Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Status Badges -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- Present Count Badge -->
                    <Border Background="#22C55E" CornerRadius="14" Padding="14,6" Margin="0,0,12,0">
                        <TextBlock x:Name="txtHeaderPresent" Text="Today: 0/0 Present" 
                                   Foreground="White" FontWeight="SemiBold" FontSize="12"/>
                    </Border>
                    
                    <!-- Active Reader Badge -->
                    <Border x:Name="borderReaderStatus" Background="#374151" CornerRadius="14" Padding="14,6">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse x:Name="readerStatusDot" Width="8" Height="8" Fill="#6B7280" Margin="0,0,8,0"/>
                            <TextBlock x:Name="txtReaderStatus" Text="No Reader" 
                                       Foreground="White" FontWeight="Medium" FontSize="12"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
                
                <!-- Date/Time and Profile -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel Margin="0,0,16,0" VerticalAlignment="Center">
                        <TextBlock x:Name="txtHeaderDate" Text="Monday, December 8, 2025" 
                                   Foreground="#9CA3AF" FontSize="12" HorizontalAlignment="Right"/>
                        <TextBlock x:Name="txtHeaderTime" Text="11:00:00 PM" 
                                   Foreground="White" FontSize="16" FontWeight="Bold" HorizontalAlignment="Right"/>
                    </StackPanel>
                    <Border Background="{StaticResource PrimaryBrush}" CornerRadius="20" Width="40" Height="40">
                        <TextBlock Text="ðŸ‘¤" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Top Section: 3 Column Layout -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="300"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left Column: Card Reader & Current Scan -->
                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                        <!-- Card Reader Status -->
                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Card Reader Status" FontWeight="Bold" FontSize="14" 
                                           Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,16"/>
                                
                                <!-- Connection Icon -->
                                <Ellipse x:Name="connectionIcon" Width="64" Height="64" 
                                         Fill="#F3F4F6" HorizontalAlignment="Center" Margin="0,0,0,8">
                                </Ellipse>
                                <TextBlock x:Name="txtConnectionStatus" Text="READER DISCONNECTED" 
                                           HorizontalAlignment="Center" FontWeight="Bold" FontSize="12"
                                           Foreground="#EF4444" Margin="0,0,0,16"/>
                                
                                <!-- COM Port Selection -->
                                <TextBlock Text="COM Port" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                <ComboBox x:Name="cmbComPort" Height="40" Margin="0,0,0,12" Style="{StaticResource ModernComboBoxStyle}"/>
                                
                                <!-- Connect Button -->
                                <Button x:Name="btnConnect" Content="Connect" Style="{StaticResource SuccessButtonStyle}"
                                        Click="BtnConnect_Click" Height="44"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Current Scan -->
                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="CURRENT SCAN" FontWeight="Bold" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}" 
 Margin="0,0,0,16"/>
                                
                                <!-- Card Icon -->
                                <Border Background="#E0F2FE" CornerRadius="12" Width="80" Height="56" 
                                        HorizontalAlignment="Center" Margin="0,0,0,12">
                                    <TextBlock Text="ðŸ’³" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <TextBlock Text="Card ID" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtCardId" Text="-" FontSize="14" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" HorizontalAlignment="Center"
                                           Margin="0,0,0,16"/>
                                
                                <!-- Employee Photo Placeholder -->
                                <Ellipse Width="80" Height="80" HorizontalAlignment="Center" Margin="0,0,0,8">
                                    <Ellipse.Fill>
                                        <ImageBrush x:Name="imgEmployee" Stretch="UniformToFill"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <Border x:Name="borderNoPhoto" Width="80" Height="80" CornerRadius="40" 
                                        Background="#F3F4F6" HorizontalAlignment="Center" Margin="0,-88,0,8">
                                    <TextBlock Text="ðŸ‘¤" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <TextBlock x:Name="txtEmployeeName" Text="-" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <Border x:Name="borderDepartment" Background="#F3F4F6" CornerRadius="10" 
                                        Padding="12,4" HorizontalAlignment="Center" Margin="0,8,0,12" 
                                        Visibility="Collapsed">
                                    <TextBlock x:Name="txtDepartment" Text="" FontSize="12" 
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                </Border>
                                
                                <!-- Status Badge -->
                                <Border x:Name="borderScanStatus" Background="#F3F4F6" CornerRadius="6" 
                                        Padding="16,8" HorizontalAlignment="Center" Margin="0,0,0,8">
                                    <TextBlock x:Name="txtScanStatus" Text="Waiting..." FontWeight="Bold" FontSize="12"/>
                                </Border>
                                
                                <TextBlock x:Name="txtScanTime" Text="" FontSize="11" 
                                           Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Register New Card (Expandable) -->
                        <Border Style="{StaticResource CardStyle}">
                            <Expander x:Name="expanderRegister" Header="Register New Card" IsExpanded="False">
                                <Expander.HeaderTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ‘¤" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="{Binding}" FontWeight="SemiBold" FontSize="14"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Expander.HeaderTemplate>
                                <StackPanel Margin="0,16,0,0">
                                    <TextBlock Text="Name" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="txtRegisterName" Style="{StaticResource ModernTextBoxStyle}" Margin="0,0,0,12"/>
                                    
                                    <TextBlock Text="Department" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <ComboBox x:Name="cmbDepartment" Height="40" Margin="0,0,0,16" Style="{StaticResource ModernComboBoxStyle}">
                                        <ComboBoxItem Content="Engineering"/>
                                        <ComboBoxItem Content="HR"/>
                                        <ComboBoxItem Content="Finance"/>
                                        <ComboBoxItem Content="Marketing"/>
                                        <ComboBoxItem Content="Operations"/>
                                        <ComboBoxItem Content="Support"/>
                                    </ComboBox>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button Content="Register" Style="{StaticResource PrimaryButtonStyle}" 
                                                Click="BtnRegister_Click" Margin="0,0,6,0"/>
                                        <Button Grid.Column="1" Content="Test Scan" Style="{StaticResource SecondaryButtonStyle}"
                                                Click="BtnTestScan_Click" Margin="6,0,0,0"/>
                                    </Grid>
                                </StackPanel>
                            </Expander>
                        </Border>
                    </StackPanel>
                    
                    <!-- Middle Column: Today's Attendance & Recent Scans -->
                    <StackPanel Grid.Column="1" Margin="0,0,20,0">
                        <!-- Today's Attendance Stats -->
                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="TODAY'S ATTENDANCE" FontWeight="Bold" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}" 
 Margin="0,0,0,16"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Total Present -->
                                    <Border Grid.Row="0" Grid.Column="0" Background="#F0FDF4" CornerRadius="8" 
                                            Padding="16" Margin="0,0,8,8">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock x:Name="txtTotalPresent" Text="0" FontSize="32" FontWeight="Bold" 
                                                       Foreground="#22C55E" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Total Present" FontSize="12" 
                                                       Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Total Absent -->
                                    <Border Grid.Row="0" Grid.Column="1" Background="#FEF2F2" CornerRadius="8" 
                                            Padding="16" Margin="8,0,0,8">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock x:Name="txtTotalAbsent" Text="0" FontSize="32" FontWeight="Bold" 
                                                       Foreground="#EF4444" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Total Absent" FontSize="12" 
                                                       Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Pending -->
                                    <Border Grid.Row="1" Grid.Column="0" Background="#F9FAFB" CornerRadius="8" 
                                            Padding="16" Margin="0,8,8,0">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock x:Name="txtPending" Text="0" FontSize="32" FontWeight="Bold" 
                                                       Foreground="{StaticResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Pending" FontSize="12" 
                                                       Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Late Arrivals -->
                                    <Border Grid.Row="1" Grid.Column="1" Background="#FFFBEB" CornerRadius="8" 
                                            Padding="16" Margin="8,8,0,0">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock x:Name="txtLateArrivals" Text="0" FontSize="32" FontWeight="Bold" 
                                                       Foreground="#F59E0B" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Late Arrivals" FontSize="12" 
                                                       Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                                
                                <!-- Attendance Rate -->
                                <StackPanel Margin="0,16,0,0">
                                    <Grid>
                                        <TextBlock Text="Attendance Rate" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock x:Name="txtAttendanceRate" Text="0%" FontSize="12" 
                                                   Foreground="{StaticResource PrimaryBrush}" FontWeight="Bold"
                                                   HorizontalAlignment="Right"/>
                                    </Grid>
                                    <Border Background="#E5E7EB" CornerRadius="4" Height="8" Margin="0,8,0,0">
                                        <Border x:Name="progressAttendance" Background="{StaticResource PrimaryBrush}" 
                                                CornerRadius="4" HorizontalAlignment="Left" Width="0"/>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Recent Scans -->
                        <Border Style="{StaticResource CardStyle}">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <TextBlock Text="RECENT SCANS" FontWeight="Bold" FontSize="12" 
                                               Foreground="{StaticResource TextSecondaryBrush}" />
                                    <TextBlock Text="View Full Log â†—" FontSize="12" Foreground="{StaticResource PrimaryBrush}"
                                               HorizontalAlignment="Right" Cursor="Hand" MouseDown="ViewFullLog_Click"/>
                                </Grid>
                                
                                <ScrollViewer MaxHeight="280" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl x:Name="lstRecentScans">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border BorderBrush="{StaticResource BorderBrush}" 
                                                        BorderThickness="0,0,0,1" Padding="0,12">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="60"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <TextBlock Text="{Binding TimeDisplay}" FontSize="12" 
                                                                   Foreground="{StaticResource TextSecondaryBrush}"
                                                                   VerticalAlignment="Center"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding Name}" FontWeight="Medium"
                                                                   VerticalAlignment="Center" Margin="8,0"/>
                                                        <Border Grid.Column="2" CornerRadius="12" Padding="10,4"
                                                                Background="{Binding Status, Converter={StaticResource StatusToBackgroundConverter}}">
                                                            <TextBlock Text="{Binding StatusDisplay}" FontSize="11" FontWeight="SemiBold"
                                                                       Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"/>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                    
                    <!-- Right Column: Quick Actions & Weekly Overview -->
                    <StackPanel Grid.Column="2">
                        <!-- Quick Actions -->
                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="QUICK ACTIONS" FontWeight="Bold" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}" 
 Margin="0,0,0,16"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <Button Grid.Row="0" Grid.Column="0" Style="{StaticResource QuickActionButtonStyle}"
                                            Click="BtnExportToday_Click" Margin="0,0,6,8">
                                        <StackPanel HorizontalAlignment="Center">
                                            <Ellipse Width="40" Height="40" Fill="#DBEAFE" Margin="0,0,0,8">
                                            </Ellipse>
                                            <TextBlock Text="ðŸ“„" FontSize="18" Margin="0,-46,0,8" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Export Today's&#x0a;Report" TextAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Grid.Row="0" Grid.Column="1" Style="{StaticResource QuickActionButtonStyle}"
                                            Margin="6,0,0,8">
                                        <StackPanel HorizontalAlignment="Center">
                                            <Ellipse Width="40" Height="40" Fill="#F3E8FF" Margin="0,0,0,8"/>
                                            <TextBlock Text="ðŸ“Š" FontSize="18" Margin="0,-46,0,8" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Generate Monthly&#x0a;Summary" TextAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Grid.Row="1" Grid.Column="0" Style="{StaticResource QuickActionButtonStyle}"
                                            Margin="0,8,6,0">
                                        <StackPanel HorizontalAlignment="Center">
                                            <Ellipse Width="40" Height="40" Fill="#D1FAE5" Margin="0,0,0,8"/>
                                            <TextBlock Text="ðŸ‘¥" FontSize="18" Margin="0,-46,0,8" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Manage Users" TextAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Grid.Row="1" Grid.Column="1" Style="{StaticResource QuickActionButtonStyle}"
                                            Margin="6,8,0,0">
                                        <StackPanel HorizontalAlignment="Center">
                                            <Ellipse Width="40" Height="40" Fill="#F3F4F6" Margin="0,0,0,8"/>
                                            <TextBlock Text="âš™ï¸" FontSize="18" Margin="0,-46,0,8" HorizontalAlignment="Center"/>
                                            <TextBlock Text="System Settings" TextAlignment="Center" FontSize="11"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- Weekly Overview -->
                        <Border Style="{StaticResource CardStyle}">
                            <StackPanel>
                                <Border Background="{StaticResource PrimaryDarkBrush}" CornerRadius="6" 
                                        Padding="12,6" HorizontalAlignment="Left" Margin="0,0,0,16">
                                    <TextBlock Text="WEEKLY OVERVIEW" FontWeight="Bold" FontSize="11" 
                                               Foreground="White" />
                                </Border>
                                
                                <!-- Simple Bar Chart -->
                                <Grid Height="140" Margin="0,0,0,16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <Rectangle Grid.Column="0" Fill="{StaticResource PrimaryBrush}" Height="100" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="1" Fill="{StaticResource PrimaryBrush}" Height="85" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="2" Fill="{StaticResource PrimaryBrush}" Height="95" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="3" Fill="{StaticResource PrimaryBrush}" Height="70" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="4" Fill="{StaticResource PrimaryBrush}" Height="110" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="5" Fill="{StaticResource PrimaryBrush}" Height="60" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                    <Rectangle Grid.Column="6" Fill="{StaticResource PrimaryBrush}" Height="40" 
                                               VerticalAlignment="Bottom" Margin="4,0" RadiusX="4" RadiusY="4"/>
                                </Grid>
                                
                                <!-- Day Labels -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Mon" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="1" Text="Tue" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="2" Text="Wed" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="3" Text="Thu" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="4" Text="Fri" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="5" Text="Sat" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="6" Text="Sun" FontSize="10" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                                </Grid>
                                
                                <!-- Stats -->
                                <Grid Margin="0,16,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Orientation="Horizontal">
                                        <Border Background="#DBEAFE" CornerRadius="4" Padding="8,4" Margin="0,0,8,0">
                                            <TextBlock Text="Avg. Daily Attendance" FontSize="10" Foreground="{StaticResource PrimaryBrush}"/>
                                        </Border>
                                        <Border Background="{StaticResource PrimaryBrush}" CornerRadius="4" Padding="8,4">
                                            <TextBlock x:Name="txtAvgAttendance" Text="0%" FontSize="10" Foreground="White" FontWeight="Bold"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                                
                                <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0" 
                                        Margin="0,16,0,0" Padding="0,12,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <Border Background="#D1FAE5" CornerRadius="4" Padding="8,4" Margin="0,0,8,0">
                                            <TextBlock Text="Most Punctual" FontSize="10" Foreground="#22C55E"/>
                                        </Border>
                                        <Border Background="#F3F4F6" CornerRadius="4" Padding="8,4">
                                            <TextBlock Text="Engineering Dept" FontSize="10" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        </Border>
                                    </StackPanel>
                                </Border>
                                
                                <TextBlock Text="â†— View Analytics" FontSize="12" Foreground="{StaticResource PrimaryBrush}"
                                           HorizontalAlignment="Center" Margin="0,16,0,0" Cursor="Hand"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
                
                <!-- Bottom Tabs Section -->
                <Border Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,20,0,0">
                    <TabControl x:Name="tabMain" Style="{StaticResource ModernTabControlStyle}">
                        <TabItem Header="Attendance Logs" Style="{StaticResource ModernTabItemStyle}">
                            <StackPanel Margin="0,16,0,0">
                                <!-- Search and Filters -->
                                <Grid Margin="0,0,0,16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBox x:Name="txtSearchLogs" Style="{StaticResource ModernTextBoxStyle}"
                                             Text="" Tag="Search by name..." Width="300" HorizontalAlignment="Left"/>
                                    
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="16,0">
                                        <TextBlock Text="ðŸ“…" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <DatePicker x:Name="dpFilterDate" Width="140"/>
                                    </StackPanel>
                                    
                                    <ComboBox Grid.Column="2" x:Name="cmbFilterDepartment" Width="150" 
                                              Style="{StaticResource ModernComboBoxStyle}" Margin="0,0,12,0">
                                        <ComboBoxItem Content="All Departments" IsSelected="True"/>
                                        <ComboBoxItem Content="Engineering"/>
                                        <ComboBoxItem Content="HR"/>
                                        <ComboBoxItem Content="Finance"/>
                                        <ComboBoxItem Content="Marketing"/>
                                        <ComboBoxItem Content="Operations"/>
                                    </ComboBox>
                                    
                                    <ComboBox Grid.Column="3" x:Name="cmbFilterStatus" Width="120" 
                                              Style="{StaticResource ModernComboBoxStyle}">
                                        <ComboBoxItem Content="All Status" IsSelected="True"/>
                                        <ComboBoxItem Content="Present"/>
                                        <ComboBoxItem Content="Late"/>
                                        <ComboBoxItem Content="Absent"/>
                                    </ComboBox>
                                </Grid>
                                
                                <!-- Export Buttons -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <Button Content="ðŸ“„ Excel" Style="{StaticResource ExcelButtonStyle}" 
                                            Padding="16,8" Margin="0,0,8,0" Click="BtnExportExcel_Click"/>
                                    <Button Content="ðŸ“„ CSV" Style="{StaticResource CsvButtonStyle}" 
                                            Padding="16,8" Margin="0,0,8,0" Click="BtnExportCsv_Click"/>
                                    <Button Content="ðŸ–¨ï¸ Print" Style="{StaticResource PrintButtonStyle}" 
                                            Padding="16,8"/>
                                </StackPanel>
                                
                                <!-- DataGrid -->
                                <DataGrid x:Name="dgLogs" Style="{StaticResource ModernDataGridStyle}"
                                          ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                          CellStyle="{StaticResource ModernDataGridCellStyle}"
                                          MaxHeight="350">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="DATE" Binding="{Binding Date}" Width="120"/>
                                        <DataGridTextColumn Header="TIME IN" Binding="{Binding TimeIn}" Width="100">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#22C55E"/>
                                                    <Setter Property="FontWeight" Value="Medium"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="TIME OUT" Binding="{Binding TimeOut}" Width="100">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#EF4444"/>
                                                    <Setter Property="FontWeight" Value="Medium"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="NAME" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTextColumn Header="DEPARTMENT" Binding="{Binding Department}" Width="140"/>
                                        <DataGridTemplateColumn Header="STATUS" Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Border CornerRadius="10" Padding="10,4" HorizontalAlignment="Left"
                                                            Background="{Binding DisplayStatus, Converter={StaticResource StatusToBackgroundConverter}}">
                                                        <TextBlock Text="{Binding DisplayStatus}" FontSize="11" FontWeight="SemiBold"
                                                                   Foreground="{Binding DisplayStatus, Converter={StaticResource StatusToColorConverter}}"/>
                                                    </Border>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="TOTAL HOURS" Binding="{Binding TotalHours}" Width="110"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                
                                <!-- Pagination -->
                                <Grid Margin="0,16,0,0">
                                    <TextBlock x:Name="txtPagination" Text="Showing 0 entries" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Content="â€¹" Style="{StaticResource SecondaryButtonStyle}" 
                                                Width="36" Height="36" Padding="0" Margin="0,0,4,0"/>
                                        <Button Content="1" Style="{StaticResource PrimaryButtonStyle}" 
                                                Width="36" Height="36" Padding="0" Margin="0,0,4,0"/>
                                        <Button Content="2" Style="{StaticResource SecondaryButtonStyle}" 
                                                Width="36" Height="36" Padding="0" Margin="0,0,4,0"/>
                                        <Button Content="3" Style="{StaticResource SecondaryButtonStyle}" 
                                                Width="36" Height="36" Padding="0" Margin="0,0,4,0"/>
                                        <Button Content="â€º" Style="{StaticResource SecondaryButtonStyle}" 
                                                Width="36" Height="36" Padding="0"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </TabItem>
                        
                        <TabItem Header="Employee Management" Style="{StaticResource ModernTabItemStyle}">
                            <StackPanel Margin="0,16,0,0">
                                <Grid Margin="0,0,0,16">
                                    <TextBox x:Name="txtSearchEmployee" Style="{StaticResource ModernTextBoxStyle}"
                                             Text="" Tag="Search employees..." Width="300" HorizontalAlignment="Left"
                                             KeyDown="TxtSearchEmployee_KeyDown"/>
                                    <Button Content="ðŸ” Search" Style="{StaticResource PrimaryButtonStyle}" 
                                            HorizontalAlignment="Left" Margin="316,0,0,0" Click="BtnSearchEmployee_Click"/>
                                </Grid>
                                
                                <DataGrid x:Name="dgEmployees" Style="{StaticResource ModernDataGridStyle}"
                                          ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                          CellStyle="{StaticResource ModernDataGridCellStyle}"
                                          MaxHeight="350">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="CARD ID" Binding="{Binding CardId}" Width="150"/>
                                        <DataGridTextColumn Header="NAME" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTextColumn Header="DEPARTMENT" Binding="{Binding Department}" Width="150"/>
                                        <DataGridTemplateColumn Header="STATUS" Width="100">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Border CornerRadius="10" Padding="10,4" HorizontalAlignment="Left"
                                                            Background="{Binding Status, Converter={StaticResource StatusToBackgroundConverter}}">
                                                        <TextBlock Text="{Binding Status}" FontSize="11" FontWeight="SemiBold"
                                                                   Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"/>
                                                    </Border>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </TabItem>
                        
                        <TabItem Header="Reports &amp; Analytics" Style="{StaticResource ModernTabItemStyle}">
                            <StackPanel Margin="0,16,0,0">
                                <Grid Margin="0,0,0,16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Text="From:" VerticalAlignment="Center" Margin="0,0,8,0" 
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <DatePicker x:Name="dpReportFrom" Grid.Column="1" Width="140" Margin="0,0,16,0"/>
                                    
                                    <TextBlock Grid.Column="2" Text="To:" VerticalAlignment="Center" Margin="0,0,8,0"
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                    <DatePicker x:Name="dpReportTo" Grid.Column="3" Width="140" Margin="0,0,16,0"/>
                                    
                                    <StackPanel Grid.Column="4" Orientation="Horizontal">
                                        <Button Content="Filter" Style="{StaticResource SecondaryButtonStyle}" 
                                                Padding="20,8" Margin="0,0,8,0" Click="BtnFilterReport_Click"/>
                                        <Button Content="Export CSV" Style="{StaticResource PrimaryButtonStyle}" 
                                                Padding="20,8" Click="BtnExportReport_Click"/>
                                    </StackPanel>
                                </Grid>
                                
                                <TextBlock x:Name="txtReportSummary" Text="Summary: IN=0, OUT=0" 
                                           Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,16"/>
                                
                                <DataGrid x:Name="dgReport" Style="{StaticResource ModernDataGridStyle}"
                                          ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                          CellStyle="{StaticResource ModernDataGridCellStyle}"
                                          MaxHeight="350">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="DATE" Binding="{Binding Date}" Width="120"/>
                                        <DataGridTextColumn Header="TIME IN" Binding="{Binding TimeIn}" Width="100"/>
                                        <DataGridTextColumn Header="TIME OUT" Binding="{Binding TimeOut}" Width="100"/>
                                        <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="80"/>
                                        <DataGridTextColumn Header="CARD ID" Binding="{Binding CardId}" Width="150"/>
                                        <DataGridTextColumn Header="NAME" Binding="{Binding Name}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </TabItem>
                    </TabControl>
                </Border>
            </Grid>
        </ScrollViewer>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Background="White" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
            <Grid Margin="20,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse Width="8" Height="8" Fill="#22C55E" Margin="0,0,8,0"/>
                    <TextBlock Text="All systems normal" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,24,0"/>
                    
                    <TextBlock Text="ðŸ•" Margin="0,0,4,0"/>
                    <TextBlock x:Name="txtLastScan" Text="Last scan: Never" FontSize="12" 
                               Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,24,0"/>
                    
                    <TextBlock Text="ðŸ’¾" Margin="0,0,4,0"/>
                    <TextBlock Text="Database synced" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ””" FontSize="14" Margin="0,0,8,0"/>
                    <Ellipse Width="8" Height="8" Fill="#EF4444" Margin="0,0,16,0"/>
                    <TextBlock Text="â“" FontSize="14"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>

